<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WasteGuard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./styles/style.css">
    <script>
        // Applica il tema immediatamente, prima di qualsiasi rendering o caricamento CSS
        (function() {
          const savedTheme = localStorage.getItem('theme');
          if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
          }
        })();
      </script>
</head>
<body>
    

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-bars"></i>
        </div>
        <div class="logo">
            <i class="fas fa-recycle"></i>
            <span>WasteGuard</span> 
        </div>
        
        <!-- Modifica la sidebar in dashboard.html -->
        <ul class="nav-links">
            <li><a href="#home" class="active" data-section="home"><i class="fas fa-home"></i> <span>Home</span></a></li>
            <li><a href="#" id="echaLink"><i class="fas fa-database"></i> <span>ECHA Database</span></a></li>
            <li><a href="#tabella-di-riscontro" data-section="tabella-di-riscontro"><i class="fas fa-table"></i> <span>Tabella di Riscontro</span></a></li>
            <li><a href="#raccolta" data-section="raccolta"><i class="fas fa-upload"></i> <span>Raccolta</span></a></li>
            <li><a href="#sali-metalli" data-section="sali-metalli"><i class="fas fa-flask"></i> <span>Sali-Metalli</span></a></li>
            <li><a href="#classificazione" data-section="classificazione"><i class="fas fa-tags"></i> <span>Classificazione</span></a></li>
            <li><a href="#report" data-section="report"><i class="fas fa-file-alt"></i> <span>Report</span></a></li>
        </ul>
       
        <!-- Contenitore tema e crediti -->
        <div class="theme-container">
            <button id="themeToggle" class="theme-btn">
                <i class="fas fa-sun"></i>
            </button>
            <div class="credits">
                <p>Developed By</p>
                <p>Biorigeneral Informatics</p>
                <p class="version" id="appVersion">WasteGuard 1.0</p>
            </div>
        </div>
    </aside>

    <!-- Bottone espansione (fuori dalla sidebar) -->
    <div class="sidebar-expand" id="sidebarExpand">
        <i class="fas fa-chevron-right"></i>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notificationText">Notifica</span>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home Section -->
        <section id="home" class="section active">
            <div class="quick-stats">
                <!-- Prima riga -->
                <div class="stat-card">
                    <i class="fas fa-file-alt"></i>
                    <div class="stat-info">
                        <h4>Report Generati</h4>
                        <p id="reportsCount">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-exclamation-triangle"></i>
                    <div class="stat-info">
                        <h4>Errori</h4>
                        <p id="errorsCount">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-clock"></i>
                    <div class="stat-info">
                        <h4>In Attesa</h4>
                        <p id="pendingStatus">NO</p>
                    </div>
                </div>
                
                <!-- Seconda riga -->
                <div class="stat-card">
                    <i class="fas fa-book-open"></i>
                    <div class="stat-info">
                        <h4>Guida Rapida</h4>
                        <button class="btn btn-primary" id="openGuideBtn">
                            <i class="fas fa-external-link-alt"></i> Vai
                        </button>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-sync"></i>
                    <div class="stat-info">
                        <h4>ECHA Database</h4>
                        <button class="btn btn-primary" id="importEchaBtn">
                            <i class="fas fa-external-link-alt"></i> Vai
                        </button>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-headset"></i>
                    <div class="stat-info">
                        <h4>Richiedi Assistenza</h4>
                        <button class="btn btn-primary" id="supportBtn">
                            <i class="fas fa-paper-plane"></i> Richiedi
                        </button>
                    </div>
                </div>
            </div>

            <div class="recent-activities">
                <h3>Attività Recenti</h3>
                <div id="activitiesContainer">
                    <!-- Le attività recenti verranno caricate dinamicamente qui -->
                    <div class="no-activities-message">
                        <i class="fas fa-info-circle"></i>
                        <p>Nessuna attività recente</p>
                    </div>
                </div>
            </div>

            <div class="data-table">
                <h3>File Salvati</h3>
                <div id="savedFilesContainer">
                    <!-- La tabella dei file salvati verrà caricata dinamicamente qui -->
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Nome File</th>
                                <th>Data e Ora</th>
                                <th>Formato</th>
                                <th>Azioni</th>
                            </tr>
                        </thead>
                        <tbody id="savedFilesTable">
                            <!-- Righe della tabella caricate dinamicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Sezione Aggiornamento Echa -->
        <section id="aggiornamento-echa" class="section">
            <h2>Aggiornamento Echa</h2>
            <div class="echa-card">
                
                <!-- Info file ECHA -->
                <div class="file-info-header" id="echaFileInfo" style="display: none;">
                    <p class="text-lg font-semibold" id="echaFileName">File: </p>
                    <p class="text-sm text-gray-600" id="echaFileDate">Caricato il </p>
                </div>
                <!-- Wrapper per la search bar con icona -->
                <div class="echa-search">
                    <div class="search-wrapper">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="echaSearchInput" placeholder="Cerca nella tabella..." oninput="searchEchaData(this.value)">
                    </div>
                </div>
                <button id="clearEchaDataBtn" class="btn btn-danger">
                    <i class="fas fa-trash"></i> Elimina dati ECHA
                </button>
                <div class="echa-results">
                    <div class="echa-results-header">
                        <h3>Risultato della ricerca</h3>
                        <span class="results-count" id="echaResultsCount">0 record</span>
                    </div>
                    <div id="echaSearchResults" class="echa-results-table-wrapper">
                        <div class="no-data-message">
                            <i class="fas fa-info-circle"></i>
                            <p>Nessun risultato disponibile.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sezione Tabella di Riscontro con sottosezioni -->
<section id="tabella-di-riscontro" class="section">
    <h2>Tabella di Riscontro</h2>
    
    <!-- Menu a tendina per le sottosezioni -->
    <div class="subsection-tabs">
        <div class="tab-item active" data-tab="aggiornamenti">
            <i class="fas fa-sync-alt"></i>
            <span>Aggiornamenti</span>
        </div>
        <div class="tab-item" data-tab="inserimenti">
            <i class="fas fa-plus-circle"></i>
            <span>Inserimenti</span>
        </div>
        <div class="tab-item" data-tab="tabella-sali">
            <i class="fas fa-flask"></i>
            <span>Tabella sali</span>
        </div>
        <div class="tab-item" data-tab="tabella-sostanze">
            <i class="fas fa-atom"></i>
            <span>Tabella sostanze</span>
        </div>
        <div class="tab-item" data-tab="frasi-h-sostanze">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Frasi H - Sostanze</span>
        </div>
        <!-- Nuova tab per Frasi EUH -->
        <div class="tab-item" data-tab="frasi-euh-sostanze">
            <i class="fas fa-exclamation"></i>
            <span>Frasi EUH - Sostanze</span>
        </div>
    </div>

 <!-- Sottosezione Aggiornamenti -->
<div id="aggiornamenti" class="subsection active">
    <div class="data-table">
        <h3>Tabella Confronto</h3>
        <p class="subsection-description">Confronto visivo delle sostanze presenti sia nel file ECHA che nel database.</p>
        
        <!-- Punto inserimento riepilogo confronto ECHA -->
        <div id="echa-comparison-summary" style="display: none;"></div>
        
        <table class="riscontro-table" id="confrontoTable">
            <thead>
                <tr>
                    <th>Sostanza</th>
                    <th>CAS</th>
                    <th>Frase H Originale</th>
                    <th>Frase H Nuova</th>
                    <th>Stato</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody id="confrontoTableBody">
                <!-- Dati caricati dinamicamente -->
            </tbody>
        </table>
        
        <div class="mt-4" id="modificatiContainer" style="display: none;">
            <h3>Sostanze Modificate</h3>
            <table class="riscontro-table" id="modificatiTable">
                <thead>
                    <tr>
                        <th>Sostanza</th>
                        <th>Nome</th>
                        <th>Frase H</th>
                        <th>Hazard Class</th>
                        <th>Output - Frase H</th>
                        <th>Output - Haz. Class</th>
                    </tr>
                </thead>
                <tbody id="modificatiTableBody">
                    <!-- Sostanze modificate caricate dinamicamente -->
                </tbody>
            </table>
            
            <div class="mt-4 text-right">
                <button id="completaModificheBtn" class="btn btn-primary">
                    <i class="fas fa-check"></i> Completa Modifiche
                </button>
            </div>
        </div>
    </div>
</div>

   <!-- Sottosezione Inserimenti rivista -->
<div id="inserimenti" class="subsection">
    <div class="insert-form-container">
        <div class="form-tabs">
            <div class="form-tab-item active" data-form="nuovaSostanza">
                <i class="fas fa-atom"></i> Nuova Sostanza
            </div>
            <div class="form-tab-item" data-form="nuovoSale">
                <i class="fas fa-flask"></i> Nuovo Sale
            </div>
        </div>
        
        <!-- Form Nuova Sostanza -->
        <div id="nuovaSostanzaForm" class="form-panel active">
            <h3>Inserimento Nuova Sostanza</h3>
            
            <div class="form-group">
                <label for="nomeSostanza">Nome Sostanza <span class="text-danger">*</span></label>
                <input type="text" id="nomeSostanza" class="form-control" placeholder="Inserisci il nome della sostanza" required>
            </div>
            
            <div class="form-group">
                <label for="codCAS">Codice CAS</label>
                <input type="text" id="codCAS" class="form-control" placeholder="Inserisci il codice CAS">
            </div>
            
            <div class="form-group">
                <label for="categoriaSostanza">Categoria</label>
                <select id="categoriaSostanza" class="form-control">
                    <option value="">Seleziona una categoria</option>
                    <option value="Metallo">Metallo</option>
                    <option value="Solvente">Solvente</option>
                    <option value="Elemento">Elemento</option>
                    <option value="Composto">Composto</option>
                    <option value="Altro">Altro</option>
                </select>
            </div>
            
            <div class="form-section">
                <h4>Frasi H e Hazard Class</h4>
                <button type="button" id="aggiungiHBtn" class="btn btn-sm btn-primary">
                    <i class="fas fa-plus"></i> Aggiungi Frase H
                </button>
                
                <div id="frasiHContainer" class="mt-4">
                    <!-- Qui verranno aggiunti dinamicamente i campi per le frasi H -->
                    <div class="frase-h-row">
                        <div class="form-group">
                            <label>Frase H</label>
                            <input type="text" class="form-control frase-h-input" placeholder="Frase H (es. H400)">
                        </div>
                        <div class="form-group">
                            <label>Hazard Class and Category</label>
                            <input type="text" class="form-control hazard-class-input" placeholder="Hazard Class (es. Aquatic Acute 1)">
                        </div>
                        <button type="button" class="btn btn-sm btn-danger remove-frase-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4>Frasi EUH</h4>
                <button type="button" id="aggiungiEUHBtn" class="btn btn-sm btn-primary">
                    <i class="fas fa-plus"></i> Aggiungi Frase EUH
                </button>
                
                <div id="frasiEUHContainer" class="mt-4">
                    <!-- Qui verranno aggiunti dinamicamente i campi per le frasi EUH -->
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" id="inserisciSostanzaBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Inserisci Sostanza
                </button>
            </div>
        </div>
        
        <!-- Form Nuovo Sale -->
        <div id="nuovoSaleForm" class="form-panel">
            <h3>Inserimento Nuovo Sale</h3>
            
            <div class="form-group">
                <label for="nomeSale">Nome Sale <span class="text-danger">*</span></label>
                <input type="text" id="nomeSale" class="form-control" placeholder="Inserisci il nome del sale" required>
            </div>
            
            <div class="form-group">
                <label for="fattoreConversione">Fattore di Conversione <span class="text-danger">*</span></label>
                <input type="number" id="fattoreConversione" class="form-control" placeholder="Inserisci il fattore di conversione" step="0.01" min="0" required>
                <small class="form-text text-muted">Utilizzato per calcolare la concentrazione effettiva del metallo</small>
            </div>
            
            <div class="form-group">
                <label for="codCasSale">Codice CAS</label>
                <input type="text" id="codCasSale" class="form-control" placeholder="Inserisci il codice CAS">
            </div>
            
            <div class="form-group">
                <label for="sostanzaAssociata">Metallo Associato <span class="text-danger">*</span></label>
                <select id="sostanzaAssociata" class="form-control" required>
                    <option value="">Seleziona un metallo</option>
                    <!-- Options caricate dinamicamente -->
                </select>
                <small class="form-text text-muted">Il metallo a cui questo sale è associato</small>
            </div>
            
            <div class="form-actions">
                <button type="button" id="inserisciSaleBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Inserisci Sale
                </button>
            </div>
        </div>
    </div>
</div>

    <!-- Sottosezione Tabella sali -->
    <div id="tabella-sali" class="subsection">
        <div class="data-table">
            <h3>Tabella Sali</h3>
            <div class="table-actions">
                <div class="search-wrapper">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="saliSearchInput" placeholder="Cerca un sale..." class="search-input">
                </div>
                <div class="table-buttons">
                    <button id="salvaSaliBtn" class="btn btn-primary" style="display: none;">
                        <i class="fas fa-save"></i> Salva Modifiche
                    </button>
                </div>
            </div>
            
            <table class="riscontro-table" id="saliTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Sali</th>
                        <th>Sinonimi</th>
                        <th>CAS</th>
                        <th>Fattore</th>
                        <th>Metallo</th>
                        <th>Default</th>
                        <th>Azioni</th>
                    </tr>
                </thead>
                <tbody id="saliTableBody">
                    <!-- Dati caricati dinamicamente -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Sottosezione Tabella sostanze -->
<div id="tabella-sostanze" class="subsection">
    <div class="data-table">
        <h3>Tabella Sostanze</h3>
        <div class="table-actions">
            <div class="search-wrapper">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="sostanzeSearchInput" placeholder="Cerca una sostanza..." class="search-input">
            </div>
        </div>
        
        <table class="riscontro-table" id="sostanzeTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>CAS</th>
                    <th>Categoria</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody id="sostanzeTableBody">
                <!-- Dati caricati dinamicamente -->
            </tbody>
        </table>
    </div>
</div>

<!-- Sottosezione Frasi H - Sostanze -->
<div id="frasi-h-sostanze" class="subsection">
    <div class="data-table">
        <h3>Frasi H - Sostanze</h3>
        <div class="table-actions">
            <div class="search-wrapper">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="frasiHSearchInput" placeholder="Cerca frase H..." class="search-input">
            </div>
            <div id="frasiHMatchCount" class="match-count"></div>
        </div>
        
        <table class="riscontro-table" id="frasiHTable">
            <thead>
                <tr>
                    <th>Nome Sostanza</th>
                    <th>CAS</th>
                    <th>Hazard Statement</th>
                    <th>Hazard Class and Category</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody id="frasiHTableBody">
                <!-- Dati caricati dinamicamente -->
            </tbody>
        </table>
    </div>
</div>
 <!-- Nuova sottosezione per Frasi EUH -->
<div id="frasi-euh-sostanze" class="subsection">
    <div class="data-table">
        <h3>Frasi EUH - Sostanze</h3>
        <div class="table-actions">
            <div class="search-wrapper">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="frasiEUHSearchInput" placeholder="Cerca frase EUH..." class="search-input">
            </div>
            <div id="frasiEUHMatchCount" class="match-count"></div>
        </div>
        
        <table class="riscontro-table" id="frasiEUHTable">
            <thead>
                <tr>
                    <th>EUH</th>
                    <th>CAS</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody id="frasiEUHTableBody">
                <!-- Dati caricati dinamicamente -->
            </tbody>
        </table>
    </div>
</div>


</div>

</section>

        <!-- Raccolta Section -->
        <section id="raccolta" class="section">
            <h2 style="padding-bottom: 2rem;">Raccolta Dati</h2>
            <div class="upload-area" id="dropZone">
                <i class="fas fa-file-excel"></i>
                <h3>Carica File Excel</h3>
                <p>Trascina qui i tuoi file Excel o clicca per selezionarli</p>
                <div class="file-progress">
                    <div class="progress-bar"></div>
                </div>
            </div>

            <div class="excel-table" id="excelDataTable" style="display: none;">
                <div class="table-toolbar">
                    <button class="btn btn-primary" id="saveChangesBtn">
                        <i class="fas fa-save"></i> Salva Modifiche
                    </button>
                    <button class="btn btn-primary" id="exportToExcelBtn">
                        <i class="fas fa-download"></i> Esporta
                    </button>
                    <!-- Aggiungi questo nuovo bottone -->
                    <button class="btn btn-danger" id="deleteFileBtn">
                        <i class="fas fa-trash"></i> Elimina File
                    </button>
                </div>
                <div class="table-container">
                    <!-- Excel data will be inserted here -->
                </div>
            </div>

            <!-- Forms di input Container -->
            <div class="raccolta-forms" id="raccoltaForms"">
                <!-- Form 1: Caratteristiche Fisiche -->
                <div class="data-table">
                    <h3>Caratteristiche Fisiche del Campione</h3>
                    <form id="caratteristicheFisicheForm" class="raccolta-form">
                        
                        <!-- Gasoli, oli e carburanti: cambia la soglia del punto di infiammabilità -->
                        <div class="form-group special-checkbox" style="margin: 1.5rem 0;">
                            <label class="checkbox-container">
                                <input type="checkbox" id="gasolioCheckbox">
                                <span class="checkmark"></span>
                                <span class="checkbox-label">Il campione contiene gasoli, carburanti o oli</span>
                            </label>
                            <small class="form-text text-muted">Seleziona questa opzione se il campione contiene prodotti derivati da petrolio come gasoli, carburanti o oli minerali.</small>
                        </div>
                        
                        <div class="form-group-grid">
                           <!-- Prima colonna -->
                            <div class="form-column">
                                <div class="form-group">
                                    <label for="colore">Colore</label>
                                    <select id="colore" class="form-control" required>
                                        <option value="">Seleziona colore...</option>
                                        <option value="Incolore">Incolore</option>
                                        <option value="Vario">Vario</option>
                                        <option value="Altro">Altro (specificare)</option>
                                    </select>
                                    <input type="text" id="coloreCustom" class="form-control mt-2" 
                                        placeholder="Specificare se 'Altro'" style="display: none;">
                                </div>
                                
                                <div class="form-group">
                                    <label for="odore">Odore</label>
                                    <select id="odore" class="form-control" required>
                                        <option value="">Seleziona odore...</option>
                                        <option value="Chimico non definibile">Chimico non definibile</option>
                                        <option value="Di carta">Di carta</option>
                                        <option value="Di idrocarburi">Di idrocarburi</option>
                                        <option value="Di legno">Di legno</option>
                                        <option value="Di solvente">Di solvente</option>
                                        <option value="Di terra">Di terra</option>
                                        <option value="Inodore">Inodore</option>
                                        <option value="Metallico">Metallico</option>
                                        <option value="Non determinabile">Non determinabile</option>
                                        <option value="Sgradevole">Sgradevole</option>
                                        <option value="Altro">Altro (specificare)</option>
                                    </select>
                                    <input type="text" id="odoreCustom" class="form-control mt-2" 
                                        placeholder="Specificare se 'Altro'" style="display: none;">
                                </div>
                                
                                <div class="form-group">
                                    <label for="statoFisico">Stato Fisico</label>
                                    <select id="statoFisico" class="form-control" required>
                                        <option value="">Seleziona stato fisico...</option>
                                        <option value="Fangoso palabile">Fangoso palabile</option>
                                        <option value="Fangoso pompabile">Fangoso pompabile</option>
                                        <option value="Liquido">Liquido</option>
                                        <option value="Solido non polverulento">Solido non polverulento</option>
                                        <option value="Solido polverulento">Solido polverulento</option>
                                        <option value="Altro">Altro (specificare)</option>
                                    </select>
                                    <input type="text" id="statoFisicoCustom" class="form-control mt-2" 
                                        placeholder="Specificare se 'Altro'" style="display: none;">
                                </div>
                                
                                <div class="form-group">
                                    <label for="ph">pH</label>
                                    <input type="text" id="ph" class="form-control" required>
                                </div>
                            </div>

                            <!-- Seconda colonna -->
                            <div class="form-column">
                                <div class="form-group">
                                    <label for="residuo105">Residuo a 105°C</label>
                                    <input type="text" id="residuo105" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="residuo180">Residuo a 180°C</label>
                                    <input type="text" id="residuo180" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="residuo600">Residuo a 600°C</label>
                                    <input type="text" id="residuo600" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="infiammabilita">Infiammabilità</label>
                                    <input type="text" id="infiammabilita" class="form-control" required>
                                </div>
                            </div>

                        </div>
                    </form>
                </div>

                <!-- Form 2: Informazioni Certificato -->
                <div class="data-table">
                    <h3>Informazioni Certificato</h3>
                    <form id="infoCertificatoForm" class="raccolta-form">
                        <div class="form-group-grid">
                            <!-- Prima colonna -->
                            <div class="form-column">
                                <div class="form-group">
                                    <label for="rapportoProva">Rapporto di prova n.</label>
                                    <input type="text" id="rapportoProva" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="descrizione">Descrizione</label>
                                    <textarea id="descrizione" class="form-control" rows="3" required></textarea>
                                </div>
                            </div>

                            <!-- Seconda colonna -->
                            <div class="form-column">
                                <div class="form-group">
                                    <label for="dataCampionamento">Data di campionamento</label>
                                    <input type="date" id="dataCampionamento" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="dataStampa">Data stampa certificato</label>
                                    <input type="date" id="dataStampa" class="form-control" required>
                                </div>
                            </div>

                            <!-- Terza colonna -->
                            <div class="form-column">
                                <div class="form-group">
                                    <label for="codiceEER">Codice EER</label>
                                    <input type="text" id="codiceEER" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="committente">Committente</label>
                                    <input type="text" id="committente" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="riferimentoVerbale">Riferimento verbale di campionamento</label>
                                    <input type="text" id="riferimentoVerbale" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="matrice">Matrice</label>
                                    <input type="text" id="matrice" class="form-control" required>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Bottoni di azione -->
                <div class="form-actions">
                    <button type="button" id="salvaInfoRaccoltaBtn" class="btn btn-primary" style="display: none">
                        <i class="fas fa-save"></i> Salva Informazioni
                    </button>
                    <button type="button" id="resetInfoRaccoltaBtn" class="btn btn-secondary">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                </div>
            </div>
        </section>

        <!-- Sezione Associazione Sali-Metalli -->
        <section id="sali-metalli" class="section">
            <h2>Associazione Sali-Metalli</h2>
            <div class="metal-association" id="metalAssociationContainer">
                <!-- Struttura dinamica: per ogni metallo identificato nel file di input, 
                     visualizza il metallo e i relativi sali associabili tramite checkbox -->
                <div class="no-data-message">
                    <i class="fas fa-info-circle"></i>
                    <p>Carica un file dalla sezione Raccolta per visualizzare le associazioni</p>
                </div>
            </div>
        </section>

        
        <!-- Sezione Classificazione (Semplificata) -->
        <section id="classificazione" class="section">
            <h2>Classificazione Rifiuti</h2>
            
            <!-- Informazioni sul file -->
            <div class="file-info-header" id="classificationFileInfo" style="display: none;">
                <p class="text-lg font-semibold" id="classificationFileName">File: </p>
                <p class="text-sm text-gray-600" id="classificationFileDate">Caricato il </p>
            </div>
            
            <!-- Pulsanti di azione -->
            <div class="action-buttons" style="margin-top: 1.5rem; margin-bottom: 1.5rem;">
                <button id="startClassificationBtn" class="btn btn-primary" style="margin-right: 1rem;">
                    <i class="fas fa-play"></i> Avvia Classificazione
                </button>
                <button id="goToReportsBtn" class="btn btn-primary" style="display: none;">
                    <i class="fas fa-folder-open"></i> Vai a Reports
                </button>
            </div>
            
            <!-- Messaggio di informazione su come ottenere i risultati -->
        <div class="info-box">
            <h3><i class="fas fa-info-circle"></i> Come funziona la classificazione</h3>
            <p>Quando avvii la classificazione, il sistema:</p>
            <ol>
                <li>Analizza i dati del campione e le sostanze con le relative frasi H</li>
                <li>Applica i valori di cut-off e limite per ogni caratteristica di pericolo (HP)</li>
                <li>Genera automaticamente un report nella sezione Reports</li>
            </ol>
            <p>Una volta completata la classificazione, usa il pulsante "Vai a Reports" per visualizzare e gestire i risultati.</p>
        </div>
        </section>
    </main>

    <!-- RICHIESTA ASSISTENZA -->
    <div class="support-dialog-overlay" id="supportDialog">
        <div class="support-dialog">
            <button class="support-dialog-close" id="closeSupportDialog">
                <i class="fas fa-times"></i>
            </button>
            <div class="support-dialog-header">
                <h3 class="support-dialog-title">Hai bisogno di aiuto?</h3>
            </div>
            <div class="support-dialog-content">
                <div class="support-item">
                    <div class="support-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <div class="support-info">
                        <h4>Supporto - Telefono</h4>
                        <p>3426403863</p>
                    </div>
                </div>
                <div class="support-item">
                    <div class="support-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="support-info">
                        <h4>Supporto - E-mail</h4>
                        <p>biorigeneralinformatics@gmail.com</p>
                    </div>
                </div>
            </div>
            <div class="support-footer">
                <p>Disponibile dal Lunedì al Venerdì, 9:00 - 18:00</p>
            </div>
        </div>
    </div>

    <!-- About Dialog -->
    <div class="support-dialog-overlay" id="aboutDialog">
        <div class="support-dialog">
            <button class="support-dialog-close" id="closeAboutDialog">
                <i class="fas fa-times"></i>
            </button>
            <div class="support-dialog-header">
                <h3 class="support-dialog-title">Informazioni</h3>
            </div>
            <div class="support-dialog-content">
                <div class="about-content">
                    <div class="about-logo">
                        <i class="fas fa-recycle"></i>
                    </div>
                    <h2>WasteGuard</h2>
                    <p id="aboutAppVersion">Versione 1.0</p>
                    <p>Sistema per la classificazione dei rifiuti</p>
                    <p>© 2024 Biorigeneral Informatics</p>
                    <p>Tutti i diritti riservati</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Dialog Conferma -->
    <div class="support-dialog-overlay" id="confirmDialog" style="display: none;">
        <div class="support-dialog">
            <div class="support-dialog-header">
                <h3 class="support-dialog-title">Conferma</h3>
            </div>
            <div class="support-dialog-content">
                <p id="confirmMessage">Sei sicuro di voler procedere?</p>
                <div class="confirm-buttons">
                    <button id="confirmYesBtn" class="btn btn-primary">
                        <i class="fas fa-check"></i> Sì
                    </button>
                    <button id="confirmNoBtn" class="btn btn-secondary">
                        <i class="fas fa-times"></i> No
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Preview Dialog -->
    <div class="support-dialog-overlay" id="reportPreviewDialog" style="display: none;">
        <div class="support-dialog" style="width: 800px; max-width: 90%;">
            <button class="support-dialog-close" id="closeReportPreviewDialog">
                <i class="fas fa-times"></i>
            </button>
            <div class="support-dialog-header">
                <h3 class="support-dialog-title">Anteprima Report</h3>
            </div>
            <div class="support-dialog-content">
                <div id="reportPreviewContent" style="max-height: 60vh; overflow-y: auto;"></div>
            </div>
            <div class="support-dialog-footer">
                <div class="report-preview-actions">
                    <button id="exportPreviewExcelBtn" class="btn btn-primary">
                        <i class="fas fa-file-excel"></i> Esporta Excel
                    </button>
                    <button id="exportPreviewPdfBtn" class="btn btn-primary">
                        <i class="fas fa-file-pdf"></i> Esporta PDF
                    </button>
                    <button id="closePreviewBtn" class="btn btn-secondary">
                        <i class="fas fa-times"></i> Chiudi
                    </button>
                </div>
            </div>
        </div>
    </div>


<!-- Sezione Reports -->
<section id="report" class="section" style="margin:0;padding:0;max-width:100%;">
    <h2>Report Generati</h2>
    
    <div style="width:100%;max-width:100%;margin:0;padding:0;">
        <div class="report-section-header" style="width:100%;margin:0;padding:0;">
            <p>Visualizza e gestisci i report di classificazione generati dall'applicazione.</p>
            
            <div class="report-filters">
                <input type="text" id="reportSearchInput" placeholder="Cerca report..." class="search-input">
                <select id="reportFormatFilter" class="form-control">
                    <option value="all">Tutti i formati</option>
                    <option value="xlsx">Excel</option>
                    <option value="pdf">PDF</option>
                    <option value="docx">Word</option>
                    <option value="json">JSON</option>
                </select>
            </div>
        </div>
        
        <div class="reports-container" style="width:100%;margin:0;padding:0;">
            <!-- Qui verranno caricati i report dinamicamente -->
        </div>
        
        <div class="no-reports-message" style="display:none;text-align:center;padding:2rem;">
            <i class="fas fa-folder-open" style="font-size:2rem;margin-bottom:1rem;"></i>
            <p>Nessun Report Disponibile</p>
            <p>I report generati appariranno qui.</p>
        </div>
        
        <div class="text-center mt-4">
            <button id="openReportsFolderBtn" class="btn btn-primary">
                <i class="fas fa-folder-open"></i> Apri Cartella Reports
            </button>
            <button id="createDemoReportBtn" class="btn btn-primary">
                <i class="fas fa-plus"></i> Crea Report Demo
            </button>
        </div>
    </div>
</section>

<!-- Dialog di anteprima report -->
<div class="support-dialog-overlay" id="reportPreviewDialog" style="display: none;">
    <div class="support-dialog" style="width: 800px; max-width: 90%;">
        <button class="support-dialog-close" id="closeReportPreviewDialog">
            <i class="fas fa-times"></i>
        </button>
        <div class="support-dialog-header">
            <h3 class="support-dialog-title">Anteprima Report</h3>
        </div>
        <div class="support-dialog-content">
            <div id="reportPreviewContent" style="max-height: 60vh; overflow-y: auto;"></div>
        </div>
        <div class="support-dialog-footer">
            <div class="report-preview-actions">
                <button id="exportPreviewExcelBtn" class="btn btn-primary">
                    <i class="fas fa-file-excel"></i> Esporta Excel
                </button>
                <button id="exportPreviewPdfBtn" class="btn btn-primary">
                    <i class="fas fa-file-pdf"></i> Esporta PDF
                </button>
                <button id="closePreviewBtn" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Chiudi
                </button>
            </div>
        </div>
    </div>
</div>



    <!-- Script per la dashboard -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="./scripts/sali-metalli.js"></script>
    <script src="./scripts/info-raccolta.js"></script>
    <script src="./scripts/classificazione.js"></script>
    <script src="./scripts/tabella-riscontro.js"></script>
    <!--ATTENZIONE dashboard va definito sempre alla fine in quanto chiama gli altri file!-->
    <script src="./scripts/dashboard.js"></script>

</body>
</html>